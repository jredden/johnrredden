<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords"
	content="Hawaii, 
Globalization, 
ScienceFiction, 
Coffee",
ZenredComputing" />

<link href="css/main.css" rel="stylesheet" type="text/css">

<script src="../js/jquery-1.8.1.min.js" type="text/javascript"></script>
<script type="text/javascript" src="../js/jquery.form.js"></script>
<script type="text/javascript">

const CHANCE_FOR_STAR_ON_START = 0.1;	// one in ten

var tagOperations = (function(){
	// private
	var showOperations = [
	  	       			function shipStartSect(){
		   					$('#shipStart').show();
		   					$('#firstposition').show();
		   				},
		   				function cosmosSpaceDetail(){
		   					$('#cosmosspacedetail').show();
		   				},
		   				function jumping(){
		   					$('#jumping').show();
		   				},
		   				function starsinclustertext(){
		   					$('#starsinclustertextcanvas').show();
		   				}

	                  	];
	var hideOperations = [
		  	       			function shipStartSect(){
			   					$('#shipStart').hide();
			   					$('#firstposition').hide();
			   				},
			   				function cosmosSpaceDetail(){
			   					$('#cosmosspacedetail').hide();
			   				},
			   				function jumping(){
			   					$('#jumping').hide();
			   				},
			   				function starsinclustertext(){
			   					$('#starsinclustertextcanvas').hide();
			   				}
			   				

	                  	];
	var references = {	
			"shipStart" : 0,
			"cosmosSpaceDetail" : 1,
			"jumping" : 2,
			"starsinclustertext" : 3
	}
	
	// public 
	return {
		show: function(showList){ 
			for(var idex = 0; idex < showList.length; idex++){
				console.log("show:" + showList[idex]);
				var token2 = references[showList[idex]];
				showOperations[token2]();
			}
		},
		hide: function(hideList){
			for (var idex = 0; idex < hideList.length; idex++){
				console.log("hide:" + hideList[idex]);
				var token2 = references[hideList[idex]];
				hideOperations[token2]();
			}
		},
		hideAll: function(){
			for(token in hideOperations){ 
				console.log("token:" + token);
				var op = hideOperations[token];
				op();
			}
		},
		both: function(showList, hideList){
			tagOperations.show(showList);
			tagOperations.hide(hideList);
		}
		
	}
}());	

/**
 * top object of a star system
 * view centric domain object
 * not "static" has to be instantiated
 */
var systemVizCentric = (function(){
	// private 
	var distanceToGalacticCentre;
	var uCoordinate;
	var vCoordinate;
	var systemName;
	
	// public
	return {
		setDistanceToGalacticCentre: function(distance){
			distanceToGalacticCentre = distance;
		},
		getDistanceToGalaticCentre: function(){
			return distanceToGalacticCentre;
		},
		setUCoordinate: function(ucoord){
			uCoordinate = ucoord;
		},
		getUCoordinate: function(){
			return uCoordinate;
		},
		setVCoordinate: function(vcoord){
			vCoordinate = vcoord;
		},
		getVCoordinate: function(){
			return vCoordinate;
		},
		setSystemName(name){
			systemName = name;
		},
		getSystemName(){
			return systemName;
		}
	}
});

/**
 * cluster of stars
 * view centric domain object
 * not "static" has to be instantiated
 */
var clusterVizCentric  = (function(){
	// private 
	var sub_cluster_description;
	var angle_in_radians_s;
	var distance_clust_virt_centre;
	var luminosity;
	var Name;
	var star_color;
	var star_size;
	var star_type;
	
	// public
	return {
		setSubClusterDescription: function(sCDescription){
			sub_cluster_description = sCDescription;
		},
		getSubClusterDescription: function(){
			return sub_cluster_description;
		},
		setAnglenInRadians: function(angInRadians){
			angle_in_radians_s = angInRadians;
		},
		getAnglenInRadians: function(){
			return angle_in_radians_s;
		},
		setDistanceClusterVirtCentre: function(distClustVirtCentre){
			distance_clust_virt_centre = distClustVirtCentre;
		},
		getDistanceClusterVirtCentre: function(){
			return distance_clust_virt_centre;
		},
		setLuminosity: function(lumin){
			luminosity= lumin;
		},
		getLuminosity: function(){
			return luminosity;
		},
		setStarName: function(SName){
			Name = SName;
		},
		getStarName: function(){
			return Name;
		},
		setStarColor: function(starColor){
			star_color = starColor;
		},
		getStarColor: function(){
			return star_color;
		},
		setStarSize: function(starSize){
			star_size = starSize;
		},
		getStarSize: function(){
			return star_size;
		},
		setStarType: function(starType){
			star_type = starType;
		},
		getStarType: function(){
			return star_type;
		}
		
	}
});

/**
 * keep x, y coordinates of a system/cluster
 * not "static" has to be instantiated
 */
var clusterViewCoordinates  = (function(){
	// private
	
	var topLeftX;
	var topLeftY;
	var bottomLeftX;
	var bottomLeftY;
	var topRightX;
	var topRightY;
	var bottomRightX;
	var bottomRightY;
	
	// public
	return {
		setAttributesFromRectangle: function(runningX, runningY, widthBoxX, widthBoxY){
			topLeftX = runningX;
			topLeftY = runningY;
			bottomLeftX = runningX;
			bottomLeftY = runningY + widthBoxY;
			topRightX = runningX + widthBoxX;
			topRightY = runningY;
			bottomRightX = runningX + widthBoxX;
			bottomRightY = runningY + widthBoxY;
		},
		getTopLeftX: function(){
			return topLeftX;
		},
		getTopLeftY: function(){
			return topLeftY;
		},
		getBottomLeftX: function(){
			return bottomLeftX;
		},
		getBottomLeftY: function(){
			return bottomLeftY;
		},
		getTopRightX: function(){
			return topRightX;
		},
		getTopRightY: function(){
			return topRightY;
		},
		getBottomRightX: function(){
			return bottomRightX;
		},
		getBottomRightY: function(){
			return bottomRightY;
		}
	}
	
});
/**
 * not static, has to be instantiated
 */
var keyValuePair  = (function(){
	// private
	var key;
	var value;
	
	return{
		setKey : function(s_key){
			key = s_key;
		},
		setValue: function(s_value){
			value = s_value;
		},
		getKey : function(){
			return key;
		},
		getValue : function(){
			return value;
		}
	}
	
});

/**
 * canvas holding area
 */
var canvasas = (function(){
	
	var starsystemscanvas;
	var starsinclustertextcanvas;
	var starsystemscanvasContext;
	var starsinclustertextcanvasContext;
	
	function buildCanvasas(){
		starsystemscanvas = document.getElementById("starsystems");
		starsystemscanvasContext = starsystemscanvas.getContext("2d");
		starsystemscanvasContext.canvas.width = window.innerWidth/2;
		starsystemscanvasContext.canvas.height = window.innerHeight;
		starsystemscanvasContext.fillStyle = "#00003D";

		
		starsinclustertextcanvas = document.getElementById("starsinclustertextcanvas");
		starsinclustertextcanvasContext = starsinclustertextcanvas.getContext("2d");
		var wi = window.innerWidth/3;
		var hi = window.innerHeight;
		console.log("HEIGHT AND WIDTH:"+wi+"::"+hi+"::");
		starsinclustertextcanvasContext.canvas.width = wi;
		starsinclustertextcanvasContext.canvas.height = hi ;
		starsinclustertextcanvasContext.canvas.style.position = 'left';
		starsinclustertextcanvasContext.fillStyle = "#00003D";

	}
	
	return{
		init: function(){
			buildCanvasas();
		},
		fetchStarSystemsCanvas(){
			return starsystemscanvas;
		},
		fetchStarSystemsCanvasContext(){
			return starsystemscanvasContext;
		},
		fetchStarsInClusterTextCanvas(){
			return starsinclustertextcanvas;
		},
		fetchStarsInClusterTextCanvasContext(){
			return starsinclustertextcanvasContext;
		}
	}
})();


$(document).ready(function() {
	console.log("in ready");
	tagOperations.hideAll();
	
	$("#home").click(function(){
		window.location = "http://www.johntredden.com";
	});
	var showList = ['shipStart'];
	tagOperations.show(showList);
	firstStop.ship();
	
	$("#jump").click(function(){
		jumpRequest.jsonCall();
	});

}); <!-- end ready -->

/**
 *  when the star ship activates it's drive
 */
var jumpRequest = (function () {
	return{
		jsonCall: function(){
			console.log("start jumpRequest");
			var showList = ['jumping'];
			var hideList = ['shipStart','cosmosSpaceDetail', 'starsinclustertext'];
			tagOperations.both(showList, hideList);

			$.getJSON("http://www.johntreddenlocal.com:8080/starSystems.html",
					function(json){           // callback
						console.log("in jumpRequest");
						processJump.jsonProcess(json);
					}		
			);
		}
	}
})();



/**
 * returned JSON is broken.  A package name is embeded in the message so
 * it has to be parsed and fixed.
 */
var processJump = (function () {
	var doOperation = function(key, value, systemVizCentricInstance){
		
		// private

		var systemsOperations = [
			function distance(instance, val){
				instance.setDistanceToGalacticCentre(val);
				return false;
			},
			function ucoord(instance, val){
				instance.setUCoordinate(val);
				return false;
			},
			function vcoord(instance, val){
				instance.setVCoordinate(val);
				return false;
			},
			function name(instance, val){
				instance.setSystemName(val);
				return true;
			}
		                      ]
		var operationArray = {
				"distance_to_galaxy_centre" : 0,
				"ucoordinate" : 1,
				"vcoordinate" : 2,
				"systemName" : 3
		}
		
		return systemsOperations[operationArray[key]](systemVizCentricInstance, value);
	}
	
	
	var systemVizCentricArray;
	
	var parseBroken = function(printthis){
	    if($.isArray(printthis) || typeof(printthis) == 'object') {
	    	var instance = new systemVizCentric();
	        for(var i in printthis) {
	        	var element = "::"+printthis[i]+"::"+i+"::";
	        	var a_match = element.toString().match("[object Object]");
	        	// console.log("MATCH:"+a_match);
	        	if(a_match != 'o'){
	        		var entry = element.split("::");
		        	console.log("ENTRY"+ entry[0]+ "|" + entry[1]+ "|" + entry[2]);
		        	var last = doOperation(entry[2], entry[1], instance);
		        	if(last){
		        		systemVizCentricArray.push(instance);
		        		instance = new systemVizCentric();
		        	}
	        	}
	            parseBroken(printthis[i]);
	        }
	    }
	}
	/**
	* wait for Cluster key values pairs from domain tier.  Hey.  It's AJAX.  
	*/
	var clusterTimerLoop = function(clusterTimer){
		console.log("WAITING FOR CLUSTER DATA");
		if(clusterValues.getClusterVizCentricArraySize() != 0){
			window.clearInterval(clusterTimer)
			console.log("CLUSTER VALUES SIZE:"+clusterValues.getClusterVizCentricArraySize());
			console.log("SYSTEM TO CLUSTER SIZE:"+clusterValues.getSystemNameArraySize());
			clusterValues.builder();
			visualizeClusters.display();
		}
	}
	// public
	return{
		jsonProcess: function(json){
			systemVizCentricArray = [];
			parseBroken(json);
			var showList = ['cosmosSpaceDetail'];
			var hideList = ['shipStart','jumping', 'starsinclustertext'];
			tagOperations.both(showList, hideList);
			clusterValues.initArrays();  // async returns go into this object
			starSystems.visualize(systemVizCentricArray);
			var clusterTimer = setInterval(function () {clusterTimerLoop(clusterTimer)}, 1000);
			
		},
		getSystemVizCentricArrayLength: function(){
			return systemVizCentricArray.length;
		}
	}
})();

var visualizeClusters = (function (){
	
	// public
	return{
		display : function(){
			var systemsWithClusters = clusterValues.fetchSystemsWithClusters();
			var clusterVizCentrics = clusterValues.fetchProcessedCluster();
			for(var idex = 0; idex < systemsWithClusters.length; idex++){
				console.log("SYSTEM WITH CLUSTER:"+systemsWithClusters[idex]);
				console.log("SubClusterDescription:"+clusterVizCentrics[idex].getSubClusterDescription());
				console.log("AnglenInRadians:"+clusterVizCentrics[idex].getAnglenInRadians());
				console.log("DistanceClusterVirtCentre:"+clusterVizCentrics[idex].getDistanceClusterVirtCentre());
				console.log("Luminosity:"+clusterVizCentrics[idex].getLuminosity());
				console.log("StarName:"+clusterVizCentrics[idex].getStarName());
				console.log("StarColor:"+clusterVizCentrics[idex].getStarColor());
				console.log("StarSize:"+clusterVizCentrics[idex].getStarSize());
				console.log("StarType:"+clusterVizCentrics[idex].getStarType());
			}
			var ctx = canvasas.fetchStarsInClusterTextCanvasContext();
			ctx.fillRect(5,20,700, window.innerHeight);
			ctx.beginPath();
			var showList = ['starsinclustertext'];
			tagOperations.show(showList);
			var startX = 5;
			var startY = 50;
			var runningX = startX;
			var runningY = startY;
			var incrementY = 20;

			for(var idex = 0; idex < systemsWithClusters.length; idex++){
				var starSystemsWithClusters = systemsWithClusters[idex];
				var subClusterDescription = clusterVizCentrics[idex].getSubClusterDescription();
				var starName = "StarName:"+clusterVizCentrics[idex].getStarName();
				var starColor = "StarColor:"+clusterVizCentrics[idex].getStarColor()+ " ";
				var starSize = "StarSize:"+clusterVizCentrics[idex].getStarSize() + " ";
				var starLuminosity = "Luminosity:"+clusterVizCentrics[idex].getLuminosity();
				ctx.font="16px Verdana";
				ctx.strokeStyle = "yellow";
				ctx.strokeText("SYSTEM WITH CLUSTER:"+starSystemsWithClusters, runningX, runningY);
				runningY += incrementY;
				ctx.font="10px Verdana";
				ctx.strokeStyle = "lightblue";
				ctx.strokeText("SubClusterDescription:"+subClusterDescription, runningX, runningY);
				runningY += incrementY;
//				ctx.strokeText("AnglenInRadians:"+clusterVizCentrics[idex].getAnglenInRadians(), runningX, runningY);
//				runningY += incrementY;
//				ctx.strokeText("DistanceClusterVirtCentre:"+clusterVizCentrics[idex].getDistanceClusterVirtCentre(), runningX, runningY);
//				runningY += incrementY;
				ctx.strokeText(starName, runningX, runningY);
				runningY += incrementY;
				ctx.strokeText(starColor, runningX, runningY);
				var colorWidth = ctx.measureText(starColor).width;
//				console.log("STAR COLOR WIDTH:"+ colorWidth);
				runningX += colorWidth ;
				ctx.strokeText(starSize, runningX, runningY);
				var luminosityWidth = ctx.measureText(starSize).width;
//				console.log("LUMINOSITY WIDTH:"+ luminosityWidth);
				runningX += luminosityWidth;
				ctx.strokeText(starLuminosity, runningX, runningY);
				runningY += incrementY;
//				ctx.strokeText("StarType:"+clusterVizCentrics[idex].getStarType(), runningX, runningY);
//				runningY += incrementY;
				runningY += incrementY;
				runningX = startX;
			}
		}
	}
})();

var clusterDetailReuquest = (function () {
	return{
		jsonCall: function(systemName){
			$.getJSON("http://www.johntreddenlocal.com:8080/starCluster.html?systemName="+systemName,
					function(json){           // callback
						console.log("in clusterDetailRequest");
						processClusterDetail.jsonProcess(json, systemName);
					}		
			);
		}
	}
})();

var processClusterDetail = (function () {
	
	// private
	
	
	// public
	return{
		jsonProcess: function(json, systemName){
			for (var idex = 0; idex < json.stars.stars.length; idex++){
				if(json.stars.stars[idex].string != undefined){
					console.log(systemName + " STARS IN CLUSTER:"+json.stars.stars[idex].string);
					clusterValues.addTosystemNameArray(systemName);
					clusterValues.addToclusterVizCentricArray(orderedPairToArray.getOrderedPair(json.stars.stars[idex].string));
				}
			}
		},
	}
	
})();

/**
 * must be reinitliazed for each jump into a star system
 *
 * cvCoordinates has already been instantiated an initialized.
 */
var clusterViewCoordinatesToSystemName = (function (){
	// private
	var clusterViewCoosrdinatesArray;
	var systemNameCoordinatesArray;
	
	return {
		initArrays: function(){
			clusterViewCoosrdinatesArray = [];
			systemNameCoordinatesArray = [];
		},
		process: function(systemName, cvCoordinates){
			clusterViewCoosrdinatesArray.push(cvCoordinates);
			systemNameCoordinatesArray.push(systemName);
		}
	}
	
})();

/**
 * build cluster values for visualizatrion after system matrix visualized.
 */
var clusterValues = (function () {
	// private
	var clusterVizCentricArray;
	var systemNameArray;
	var clusterVizCentricArray2;
	var systemNameArray2;
	
	var setOperations = [
	                     function setSystemName(name){
	                    	 systemNameArray2.push(name);
	                     	 console.log("SYSTEM_NAME"+name+"::"+systemNameArray2.length-1);
	                  	   
	                     },
	                     function setInstance(instance){
	                    	 clusterVizCentricArray2.push(instance);  // instance of clusterVizCentric
	                    	 console.log("CLUSTER_VIZ_CENTRIC.length"+clusterVizCentricArray2.length);
	                     },
	                     function setSubClusterDescription(description){
	                    	 clusterVizCentricArray2[clusterVizCentricArray2.length-1].setSubClusterDescription(description);
	                    	 console.log("SUBCLUSTER_DESCRIPTION"+description+"::"+clusterVizCentricArray2.length-1);
	                     },
	                     function setAnglenInRadians(angle){
	                    	 clusterVizCentricArray2[clusterVizCentricArray2.length-1].setAnglenInRadians(angle);
	                     	 console.log("ANGLE_IN_RADIANS:"+angle+"::"+clusterVizCentricArray2.length-1);
	                  	                     },
	                     function setDistanceClusterVirtCentre(distance){
	                    	 clusterVizCentricArray2[clusterVizCentricArray2.length-1].setDistanceClusterVirtCentre(distance);
	                    	 console.log("DISTANCE CENTRE:"+distance+"::"+clusterVizCentricArray2.length-1);
	                     },
	                     function setLuminosity(lumens){
	                    	 clusterVizCentricArray2[clusterVizCentricArray2.length-1].setLuminosity(lumens);
	                    	 console.log("LUMENS:"+lumens+"::"+clusterVizCentricArray2.length-1);
	                     },
	                     function setStarName(name){
	                    	 clusterVizCentricArray2[clusterVizCentricArray2.length-1].setStarName(name);
	                    	 console.log("STAR_NAME:"+name+"::"+clusterVizCentricArray2.length-1);
	                     },
	                     function setStarColor(color){
	                    	 clusterVizCentricArray2[clusterVizCentricArray2.length-1].setStarColor(color);
	                    	 console.log("STAR_COLOR:"+color+"::"+clusterVizCentricArray2.length-1);
	                     },
	                     function setStarSize(size){
	                    	 clusterVizCentricArray2[clusterVizCentricArray2.length-1].setStarSize(size);
	                    	 console.log("STAR_SIZE:"+size+"::"+clusterVizCentricArray2.length-1);
	                     },
	                     function setStarType(type){
	                    	 clusterVizCentricArray2[clusterVizCentricArray2.length-1].setStarType(type);
	                    	 console.log("STAR_TYPE:"+type+"::"+clusterVizCentricArray2.length-1);
	                     }
	                    ];
	
						var references = {
								"systemName" : 0,
								"instance" : 1,
								"sub_cluster_description" : 2,
								"angle_in_radians_s" : 3,
								"distance_clust_virt_centre" : 4,
								"luminosity" : 5,
								"Name" : 6,
								"star_color" : 7,
								"star_size" : 8,
								"star_type" : 9
						}
	return{
		initArrays: function(){
			clusterVizCentricArray = [];
			systemNameArray = [];
		},
		addTosystemNameArray: function (systemName){
			systemNameArray.push(systemName);
		},
		addToclusterVizCentricArray: function(keyValuePair){
			// console.log("ADDING KEYVALUE:"+keyValuePair+" SIZE:"+clusterVizCentricArray.length);
			clusterVizCentricArray.push(keyValuePair);
		},
		getClusterVizCentricArraySize(){
			return clusterVizCentricArray.length;
		},
		getSystemNameArraySize(){
			return systemNameArray.length;
		},
		builder(){
			if(clusterVizCentricArray.length != systemNameArray.length){
				throw "Cluster Lengths not equal"+clusterVizCentricArray.length+"::"+systemNameArray.length;
			}
			clusterVizCentricArray2 = [];
			systemNameArray2 = [];
	
			for(var idex = 0; idex <  systemNameArray.length; idex++){
				
				setOperations[references["systemName"]](systemNameArray[idex]);
				setOperations[references["instance"]](new clusterVizCentric());
				for(var idex2 = 0; idex2 < clusterVizCentricArray.length; idex2++){  // number stars in cluster
//					console.log('STAR_COUNT:'+idex);
					var pairs = clusterVizCentricArray[idex2];
					for(var idex3 = 0; idex3 < pairs.length; idex3++ ){
						var pair = pairs[idex3];
						setOperations[references[pair.getKey()]](pair.getValue());
					}
					setOperations[references["instance"]](new clusterVizCentric());
				}
			}
		},
		fetchProcessedCluster(){
			return clusterVizCentricArray2;
		},
		fetchSystemsWithClusters(){
			return systemNameArray2;
		}

	}
	
})();

/**
 * used to draw the initial canvas
 */
var draw = (function(){
	
	// private
	var sizes = [5,4,4,3,3,3,3,2,2,2,2,2];
	var colors = ['white', 'lightblue', 'blue', 'lightyellow', 'yellow', 'orange', 'red', '#580058']
	var sizesLength = sizes.length;
	var colorsLength = colors.length;
	
	// public
	return {
		sizeStar: function(){
			var index_s = Math.floor(Math.random() * sizesLength);
			return sizes[index_s];
		},
		color: function(){
			var index_c = Math.floor(Math.random() * colors.length);
			return colors[index_c];
		},
		chance: function(){
			var randomNumber = Math.random();
			// console.log("randomNumber:"+randomNumber);
			if(randomNumber < CHANCE_FOR_STAR_ON_START){
				return true;
			}
			else{
				return false;
			}
		}
	}
}()); <!-- end draw -->

/*
 * When opening the page, this is the start point
 */
var firstStop = (function () {
	return{
		ship: function(){
			console.log("ship outside cosmos");
			var canvas = document.getElementById("firstposition");
			var ctx = canvas.getContext("2d");
			ctx.canvas.width = window.innerWidth;
			ctx.canvas.height = window.innerHeight;
			ctx.fillStyle = "#00003D";
			ctx.fillRect(0,20,window.innerWidth, window.innerHeight);
			
			var startx = 5;
			var starty = 15;
			
			while (starty < canvas.height){
				while(startx < canvas.width){
					var chance = draw.chance();
					if(chance){
						var size = draw.sizeStar();
						var color = draw.color();
						// console.log("size:" + size+ " color:" + color + " chance:" + chance);
						ctx.beginPath();
						ctx.arc(startx, starty, size, 0, 2*Math.PI, false);
						ctx.fillStyle = color;
						ctx.fill();
						ctx.lineWidth=0;
						ctx.stroke();
					}
					startx += 7;
				}
				startx = 5;
				starty += 7;
			}
		}
	}
})();

var starSystems = (function () {
	return{
		visualize: function(systemVizCentricArray){
			clusterViewCoordinatesToSystemName.initArrays();
			canvasas.init();
			var ctx = canvasas.fetchStarSystemsCanvasContext();
			ctx.fillRect(0,20,window.innerWidth/2, window.innerHeight);
			
			var lineWidth = 2;
			var flipFlop = 0;
			var startX = 50;
			var startY = 50;
			var incrementHeaderX = 20;
			var widthBoxY= 150;
			var widthBoxX = 150
			var runningX = startX;
			var runningY = startY;
			var fillStyle;
			var reset;
			console.log("LENGTH:"+systemVizCentricArray.length);
			ctx.beginPath();
			for(var idex = 0; idex < systemVizCentricArray.length; ){
				if(flipFlop == 0){
					fillStyle = 'darkblue';
				}
				else{
					fillStyle = 'midnightblue';
				}
				ctx.rect(runningX, runningY, widthBoxX, incrementHeaderX);
				ctx.fillStyle = fillStyle;
				ctx.fillRect(runningX, runningY, widthBoxX, incrementHeaderX);
				ctx.lineWidth= lineWidth;
				ctx.strokeStyle= "lightblue";
				ctx.stroke();
				
				var cvCoordinates = new clusterViewCoordinates();
				cvCoordinates.setAttributesFromRectangle(runningX, runningY, widthBoxX, widthBoxY);
				console.log("CVCOORDINATES:"+cvCoordinates.getTopLeftX()
						+"|"+cvCoordinates.getTopLeftY()
						+"|"+cvCoordinates.getBottomRightX()
						+"|"+cvCoordinates.getBottomRightY());
				clusterViewCoordinatesToSystemName.process(systemVizCentricArray[idex].getSystemName(),cvCoordinates);
				
				var header = "U"+systemVizCentricArray[idex].getUCoordinate()+":V"+systemVizCentricArray[idex].getVCoordinate();
				// console.log("HEADER:"+header);
				ctx.font="16px Verdana";
				ctx.strokeText(header, runningX+2, runningY+15);
				
				clusterDetailReuquest.jsonCall(systemVizCentricArray[idex].getSystemName());
				
				runningY += incrementHeaderX;
				
				if(flipFlop == 0){
					fillStyle = 'midnightblue';
				}
				else{
					fillStyle = 'darkblue';
				}
				ctx.rect(runningX, runningY, widthBoxX, widthBoxY);
				ctx.fillStyle = fillStyle;
				ctx.fillRect(runningX, runningY, widthBoxX, widthBoxY);
				ctx.lineWidth= lineWidth;
				ctx.strokeStyle= "lightblue";
				ctx.stroke();
				
				runningY -= incrementHeaderX;
				
				flipFlop ^=1;
				runningX+=widthBoxX;
				++idex;
				reset = idex % 5;
				if(reset == 0){
					runningX = startX;
					runningY += widthBoxY;
				}
			}
			ctx.closePath();
		}
	}
})();

/**
 * builds array of arrays holding ordered pairs
 */
var orderedPairToArray = (function (){
	return{
		getOrderedPair: function (oneString){
			var result = [];
			var arrayOfUnsplitOrderedPairs = oneString.toString().split(";");
			for(var idex = 0; idex < arrayOfUnsplitOrderedPairs.length; idex++){
				var kvPair = new keyValuePair();
				var kvArray = arrayOfUnsplitOrderedPairs[idex].split("=");
				kvPair.setKey(kvArray[0]);
				kvPair.setValue(kvArray[1]);
				// console.log("KVPAIR:"+kvPair.getKey()+"::"+kvPair.getValue());
				result.push(kvPair);
			}
			return result;
		}
	}
})();

//for debugging
function print_recursive(printthis) {
    var output = '';

    if($.isArray(printthis) || typeof(printthis) == 'object') {
        for(var i in printthis) {
        	console.log("??:"+printthis[i]+"::"+i);
            output += i + ' : ' + print_recursive(printthis[i]) + '\n';
        }
    }else {
        output += printthis;
    }
    console.log("PRINT:"+output);
}
</script>

<title>Cosmos Website</title>
</head>
<body id="cosmosspace">
	<div id="wrapperspace">
			<header id="topHeader">
			<hgroup>
				<nav id="topNav">
					<button id="home">Home</button>
					<button id="jump">Activate Starships Star Drive</button>
					<span id="jumphint" style="color:lightyellow;font-weight:bold">To travel to a new star system activate the Star Drive</span>
				</nav>
			</hgroup>
		</header>
	</div> <!--  wrapperspace -->
	<section id="cosmosspacedetail">
	<canvas id="starsystems">
	Your browser does not support the HTML5 canvas tag.
	Please upgrade to a version with full support for HTML5.
	
	</canvas>
	
	Star Systems in this Sector
	<canvas id="starsinclustertextcanvas">
	Your browser does not support the HTML5 canvas tag.
	Please upgrade to a version with full support for HTML5.
	
	</canvas>
	
	</section> <!-- end cosmosspacedetail -->
	
	<section id="shipstart">
	<canvas id="firstposition">
	Your browser does not support the HTML5 canvas tag.
	Please upgrade to a version with full support for HTML5.
	</canvas>
	
	</section> <!--  end shipstart -->
	<section>
	<div id="jumping">
	<img src="./JumpingToLightSpeed.gif" width="1360" height="1000" />
	</div>
	</section>
</body>
</html>