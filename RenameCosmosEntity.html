<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<link href="../css/main.css" rel="stylesheet" type="text/css">

<script src="../js/jquery-3.0.0.min.js" type="text/javascript"></script>
<script type="text/javascript" src="../js/jquery.form.js"></script>
<script type="text/javascript" src="../js/buckets.js"></script>
<script type="text/javascript" src="../js/cosmosCommon.js"></script>
<script type="text/javascript">


/**
 * single line of renameable entity, new must be used
 */
var renameLine = (function(){
	
	// private
	
	var genericName;
	var entityType;
	var renamesArray = [];
	var renames_count = 0;
	
	//public
	
	return {
		setGenericName: function(name){
			genericName = name;
		},
		getGenericName: function(){
			return genericName;
		},
		setType: function(type){
			entityType = type;
		},
		getType: function(){
			return entityType;
		},
		addRename:  function(rename){
			renamesArray[renames_count] = rename;
			++renames_count;
		},
		getRenamesArray: function(){
			return renamesArray;
		}
	}
	
});

var parseRenameStream  = (function(){
	
	// public
	
	return{
		cluster: function(){
			$.getJSON("http://www.localhost:8080/johntredden-1.0/listClusterRenameCandidates.html",
					function(json){           // callback
						console.log("in cluster:"+json);
						processChoice.jsonProcess(json);
					}
			);
			
		},
		star: function(){
			$.getJSON("http://www.localhost:8080/johntredden-1.0/listStarRenameCandidates.html",
					function(json){           // callback
						console.log("in star:"+json);
						processChoice.jsonProcess(json);
					}
			);
			
		},
		planar: function(){
			$.getJSON("http://www.localhost:8080/johntredden-1.0/listPlanetoidRenameCandidates.html",
					function(json){           // callback
						console.log("in planetoids:"+json);
						processChoice.jsonProcess(json);
					}
			);
			
		}
	}

}());

var processChoice = (function(){
	
	// public
	
	return {
		jsonProcess: function(json){
			var candidates = json.list[0];
			console.log(candidates);
			var lineArray = parseCandidates.parse(candidates);
			for (var idex in lineArray){
				
				var renameArray = lineArray[idex].getRenamesArray();
				console.log(lineArray[idex].getGenericName() + " "
						+ lineArray[idex].getType() + " ");
				for(var idex2 in renameArray){
					console.log( " " + renameArray[idex2] + " ");
				}
				
			}
		}
	}
	
})();

var parseCandidates = (function(){
	
	var lineArray = [];
	var lineCount = 0;
	var workingRenameLine;
	var state;
	
	return{
		parse: function(stream){
			var output = '';
		    if($.isArray(stream) || typeof(stream) == 'object') {
		        for(var idex in stream) {
		        	switch(idex){
		        	case "genericName":
		        		state = 'start';
		        		workingRenameLine = new renameLine();
		        		break;
		        	
		        	case "renameObjectType":
		        		state = 'objectType';
		        		break;
		        		
		        	case "renames":
		        		state = 'renames';
		        		break;
		        	default:
		        		// probably object as name
		        	}
		        	parseCandidates.parse(stream[idex]);
		        }
		    }else {
		        output += stream;
		    }
		    if(output.length > 0){
		    	// console.log("state:" + state + " PRINT:"+output);
		    	switch (state){
		    	
		    	case "start":
		    		workingRenameLine.setGenericName(output);
		    		break;
		    		
		    	case "renames":
		    		workingRenameLine.addRename(output);
		    		break;
		    		
		    	case "objectType":
		    		workingRenameLine.setType(output);
		    		lineArray[lineCount++] = workingRenameLine;
		    		break;
		    		
		    	default:
		    		console.log("warning:" + state);
		    }
		 }
		 return lineArray;   
	   }
	}
	
})();



$(document).ready(function() {
	
	$("#home").click(function(){
		window.location = "http://johntreddenlocal.com";
	});
	$("#renameCluster").click(function(){
		parseRenameStream.cluster();
		
	});
	$("#renameStar").click(function(){
		parseRenameStream.star();
	});
	$("#renamePlanetoid").click(function(){
		parseRenameStream.planar();
	});

});


//for debugging
function print_recursive(printthis) {
    var output = '';

    if($.isArray(printthis) || typeof(printthis) == 'object') {
        for(var i in printthis) {
        	console.log("??:"+printthis[i]+"::"+i);
            output += i + ' : ' + print_recursive(printthis[i]) + '\n';
        }
    }else {
        output += printthis;
    }
    console.log("PRINT:"+output);
}
</script>

<title>Rename Cosmos Entity</title>
</head>

<body id="renameSpace">
	<div id="wrapperspace">
		<!--  wrapperspace -->
		<header id="topHeaderFixed">
			<hgroup>
				<nav id="topRenameCosmosEntity">
					<button id="home">Home</button>
					<button id="renameCluster">Rename a Cluster</button>
					<button id="renameStar">Rename a Star</button>
					<button id="renamePlanetoid">Rename a Planetoid</button>
				</nav>
			</hgroup>
		</header>
	</div>
</body>
</html>